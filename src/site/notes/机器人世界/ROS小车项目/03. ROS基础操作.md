---
{"dg-publish":true,"permalink":"/机器人世界/ROS小车项目/03. ROS基础操作/"}
---


# ROS1

## Catkin编译系统
案例采用 [# Commit 3672079](https://github.com/KenSporger/ros_21/commit/3672079c2e3db58019ff5f53554039c91680be26)

ROS1采用Catkin编译系统，一个工作空间中可以放置多个功能包，工作空间的结构如下：
+ src：代码空间，存放所有[[机器人世界/ROS小车项目/01. ROS1架构学习#^25df91\|ROS功能包的源码文件]]；
+ build：编译空间，存储编译过程的产出；
+ devel：开发空间，用来存储编译生成的可执行文件；
+ install：安装空间，`make install`的安装目录，很多工作空间并没有这个；
例如一个话题订阅发布功能包，在编译之前的工作空间如下：
```
.
└── src
    └── learning_topic
        ├── CMakeLists.txt
        ├── msg
        │   └── Person.msg
        ├── package.xml
        └── src
            ├── person_publisher.cpp
            ├── person_subscriber.cpp
            ├── pose_subscriber.cpp
            └── velocity_publisher.cpp
```
然后在工作空间根目录执行`catkin_make`进行编译，编译完后的工作空间如下：
```
.
├── build
│   ├── CMakeCache.txt
│   ├── CMakeFiles           # 如果编译报错，可以检查这个文件夹下的CMakeError.log
│   ├── Makefile
│   ├── learning_topic       # learning_topic功能包专属的编译缓存
│   │   ├── Makefile
├── devel
│   ├── include
│   │   └── learning_topic
│   │       └── Person.h     # msg数据类型定义生成的头文件
│   ├── lib
│   │   ├── learning_topic   # 可执行文件存放目录
│   │   │   ├── person_publisher_node
│   │   │   ├── person_subscriber_node
│   │   │   ├── pose_subscriber_node
│   │   │   └── velocity_publisher_node
│   ├── local_setup.bash
│   ├── setup.bash           # 编译后source这个文件，就能在命令行中全局执行person_publisher_node...
├── src
│   └── learning_topic
│       ├── CMakeLists.txt
│       ├── msg
│       ├── package.xml
```

## 运行节点

+ 启动master节点。
```sh
roscore
```
+ 运行功能节点
```sh
# rosrun 功能包名 节点名
rosrun learning_topic person_publisher_node 
```

## launch文件


# ROS2

## 工作空间创建

ROS2使用colcon作为构建工具
```sh
sudo apt update && sudo apt install -y python3-colcon-common-extensions
colcon build
# 加载当前工作空间的环境（临时生效） 
source install/setup.bash
# 全量编译
colcon build
# 仅编译src下的my_package功能包 
colcon build --packages-select my_package
```
- `build`：编译过程中生成的中间文件（如 CMake 缓存、编译日志）；
- `install`：编译后的可执行文件、库、环境配置文件（核心，需 source 此目录的 setup 文件）；
- `log`：编译日志文件（排查编译错误用）。

## 运行

```sh
# 查看功能包下的可执行节点（替换为你的包名）
ros2 pkg executables controller

```